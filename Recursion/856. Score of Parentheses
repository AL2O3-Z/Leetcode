class Solution {
public:
    int scoreOfParentheses(string S) {
        return helper(S, 0, S.size() - 1);
    }
    int helper(const string S, int l, int r) {
        if (r - l == 1) return 1;
        int open = 0;
        int res = 0;
        for (int i = l ; i < r; i ++) {
            if (S[i] == '(') open++;
            if (S[i] == ')') open--;
            if (open == 0) {
                return helper(S, l, i) + helper(S, i + 1, r);
            }
        }
        return 2 * helper(S, l + 1, r - 1);
    }
};
